{"ast":null,"code":"import _regeneratorRuntime from \"/home/esteakshapin/Documents/omingle/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/esteakshapin/Documents/omingle/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nvar _jsxFileName = \"/home/esteakshapin/Documents/omingle/src/pages/play/queue/queue.jsx\";\nimport React from 'react';\nimport axios from 'axios';\nimport { withRouter } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Queue extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      playersWaiting: 0,\n      intervalId: '',\n      userId: null\n    };\n    this.checkTeam = this.checkTeam.bind(this);\n  }\n\n  checkTeam() {\n    axios({\n      method: 'GET',\n      url: 'http://localhost:8000/team/get_team/',\n      headers: {\n        Authorization: \"JWT \".concat(localStorage.getItem('token'))\n      }\n    }).then(res => {\n      if (!res.data.queryroom.players_waiting.includes(this.state.userId)) {\n        alert('You need to join the queue!');\n        this.props.history.push('/play/');\n      } else if (res.data.team.length > 0) {\n        this.props.history.push('lobby');\n      } else {\n        this.setState({\n          playersWaiting: res.data.queryroom.players_waiting.length\n        });\n      }\n    });\n  }\n\n  componentDidMount() {\n    var _this = this;\n\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var intervalId;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return axios({\n              method: 'GET',\n              url: 'http://localhost:8000/rest-auth/user/',\n              headers: {\n                Authorization: \"JWT \".concat(localStorage.getItem('token'))\n              }\n            }).then(res => _this.setState({\n              userId: res.data.id\n            })).catch(error => console.log(error));\n\n          case 2:\n            try {\n              _this.checkTeam();\n\n              intervalId = setInterval(() => {\n                _this.checkTeam();\n              }, 5000);\n\n              _this.setState({\n                intervalId: intervalId\n              });\n            } catch (e) {\n              console.log('error');\n            }\n\n          case 3:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee);\n    }))();\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.state.intervalId);\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\"Queue Page\", /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: this.state.playersWaiting\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default _c = withRouter(Queue);\n\nvar _c;\n\n$RefreshReg$(_c, \"%default%\");","map":{"version":3,"sources":["/home/esteakshapin/Documents/omingle/src/pages/play/queue/queue.jsx"],"names":["React","axios","withRouter","Queue","Component","constructor","props","state","playersWaiting","intervalId","userId","checkTeam","bind","method","url","headers","Authorization","localStorage","getItem","then","res","data","queryroom","players_waiting","includes","alert","history","push","team","length","setState","componentDidMount","id","catch","error","console","log","setInterval","e","componentWillUnmount","clearInterval","render"],"mappings":"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","sourcesContent":["import React from 'react';\nimport axios from 'axios';\nimport { withRouter } from 'react-router-dom';\n\nclass Queue extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            playersWaiting: 0,\n            intervalId: '',\n            userId: null\n        }\n        this.checkTeam = this.checkTeam.bind(this);\n    }\n\n    checkTeam() {\n        axios({\n            method: 'GET',\n            url: 'http://localhost:8000/team/get_team/',\n            headers: {\n                Authorization: `JWT ${localStorage.getItem('token')}`,\n\n            },\n        }).then((res) => {\n            if (!res.data.queryroom.players_waiting.includes(this.state.userId)) {\n                alert('You need to join the queue!');\n                this.props.history.push('/play/')\n            } else if (res.data.team.length > 0) {\n                this.props.history.push('lobby')\n            }\n            else {\n                this.setState({\n                    playersWaiting: res.data.queryroom.players_waiting.length\n                })\n            }\n        })\n    }\n\n    async componentDidMount() {\n        await axios({\n            method: 'GET',\n            url: 'http://localhost:8000/rest-auth/user/',\n            headers: {\n                Authorization: `JWT ${localStorage.getItem('token')}`,\n\n            },\n        })\n            .then((res) => this.setState({ userId: res.data.id }))\n            .catch(error => console.log(error));\n\n        try {\n            this.checkTeam();\n            let intervalId = setInterval(() => {\n                this.checkTeam();\n            }, 5000)\n\n            this.setState({ intervalId: intervalId });\n\n        } catch (e) {\n            console.log('error');\n        }\n    }\n\n    componentWillUnmount() {\n        clearInterval(this.state.intervalId);\n    }\n\n    render() {\n        return (\n            <div>\n                Queue Page\n                <h1>{this.state.playersWaiting}</h1>\n            </div>\n        )\n    }\n}\n\nexport default withRouter(Queue);"]},"metadata":{},"sourceType":"module"}